<<<<<<< HEAD
# 見比べて選ぶ（4分割比較画面）要件定義

> スキャン後の削除モードにおける「スワイプで削除」を廃止し、代わりに「見比べて選ぶ」機能を追加する。  
> 本文書は実装前の要件定義であり、実装は「実装をお願いします」の依頼があるまで行わない。

---

## 1. 背景・目的

- **現状の課題**: スキャン結果のグループで「スワイプで削除」を使う場合、写真を見比べて選択することができない。
- **目的**: グループ内の写真を並べて比較し、「残す」をタップで選択しやすくする。

---

## 2. スコープ

| 対象 | 内容 |
|------|------|
| **廃止するもの** | スキャン後の削除モードにおける「スワイプで削除」（まとめてスワイプ／グループ単位スワイプ）。グループカードの「スワイプで整理」ボタンおよび ScanScreen の「まとめてスワイプ」ボタンを削除する。 |
| **残すもの** | オンボーディングから選択できる「全ての写真をスワイプで整理」モード（SwipeAllPhotosScreen）。 |

---

## 3. 新機能「見比べて選ぶ」

### 3.1 入口

- **グループカード（PhotoGroupCard）**
  - サムネイルを**少し大きく**表示する（比較しやすくするため。例: 3列 → 2列など）。
  - **「見比べて選ぶ」**ボタンを1つ追加する。押下で 4分割比較画面に遷移する。
  - 従来の「スワイプで整理」ボタンは削除する。

### 3.2 4分割比較画面（新規画面）

#### 表示レイアウト

- **縦写真のみのグループ**: **2×2**（4枚を2行2列で表示）。
- **横写真のみのグループ**: **4行1列**（4枚を縦に1列で並べる）。
- **縦横混合のグループ**: **2×2**。
- **5枚目以降**: 縦スクロールで、上記ルールに従い 4枚ずつのブロックとして続けて表示する。

**写真の表示仕様**

- 写真全体を表示するのではなく、**表示枠（セル）いっぱいに写真を表示**する。フチが少し見切れていても構わない（aspect fill / 中心寄せでセルを埋める）。
- 元の写真サイズのままでは見比べにくいため、**見比べられる程度の大きさに縮小して表示**する。4枚が同じくらいのスケールで並び、比較しやすいサイズとする。

#### 選択ルール

- **タップ** → その写真を「残す」にする（トグル想定か、タップ＝残すのみかは実装時に合わせてよい）。
- **タップしていない写真** → 削除候補とする。

#### 操作・UI

- **ピンチアウト**: 4分割画面全体をズームする。
- **長押し（1枚）**: その写真をモーダルで大きく表示する。
- **戻るボタン**: 4分割画面を閉じ、ScanScreen のグループ一覧に戻る。選んだ「残す」はストアに反映済みの状態で戻る。
- **説明文**: 「ピンチでズーム、長押しで大きく表示」を小さく表示する。

#### ボタン（4分割画面内）

| ボタン | 動作 |
|--------|------|
| **このグループで削除を実行** | このグループ内の削除候補（残す以外）を確認ダイアログのうえで削除する。 |
| **まとめて削除** | 同上（このグループ内の削除候補を一括削除）。 |
| **次のグループへ** | 次のグループの 4分割比較画面に移行する。最後のグループの場合は「最後のグループです」等の扱いとする。 |

#### アクセシビリティ

- 各写真セルにラベルを付与する（例: 「1枚目、残す選択」「2枚目、削除予定」など）。VoiceOver 等で読み上げ可能にする。

---

## 4. データ・画面遷移

- **ストア**: 4分割画面での「残す」選択は、既存の `keepAssetIds`（SimilarGroup）および `setKeepAssets` で管理する。戻る時点でストアに反映されている。
- **削除実行**: 既存の `deleteAssets(assetIds)` および `removeAssetsFromGroups(assetIds)` を使用する。確認はアラートで行う。
- **次のグループへ**: 現在のグループインデックスとグループIDリストを持ち、次のインデックスで同じ 4分割画面を開き直す（パラメータだけ差し替え）。

---

## 5. 文言・i18n

| キー（想定） | 日本語 |
|--------------|--------|
| 見比べて選ぶ（ボタン） | 見比べて選ぶ |
| 戻る | 戻る |
| このグループで削除を実行 | このグループで削除を実行 |
| まとめて削除 | まとめて削除 |
| 次のグループへ | 次のグループへ |
| ヒント | ピンチでズーム、長押しで大きく表示 |
| ラベル（例） | 1枚目、残す選択 / 2枚目、削除予定 など |

※ キー名・英語訳は実装時に i18n 構造に合わせて定義する。

---

## 6. 非機能・その他

- サムネイル取得は既存の `getThumbnailURL` / `getThumbnailURLs`、拡大表示は `getPreviewImage` を利用する。
- 既存のテーマ（`src/theme/index.ts`）に従う。
- 実装は「実装をお願いします」と依頼があるまで行わない。

---

*作成日: 要件議論の整理として作成。実装前に本要件定義の内容で合意済みとする。*
=======
# 見比べて選ぶ（4分割比較画面）要件定義

> スキャン後の削除モードにおける「スワイプで削除」を廃止し、代わりに「見比べて選ぶ」機能を追加する。  
> 本文書は実装前の要件定義であり、実装は「実装をお願いします」の依頼があるまで行わない。

---

## 1. 背景・目的

- **現状の課題**: スキャン結果のグループで「スワイプで削除」を使う場合、写真を見比べて選択することができない。
- **目的**: グループ内の写真を並べて比較し、「残す」をタップで選択しやすくする。

---

## 2. スコープ

| 対象 | 内容 |
|------|------|
| **廃止するもの** | スキャン後の削除モードにおける「スワイプで削除」（まとめてスワイプ／グループ単位スワイプ）。グループカードの「スワイプで整理」ボタンおよび ScanScreen の「まとめてスワイプ」ボタンを削除する。 |
| **残すもの** | オンボーディングから選択できる「全ての写真をスワイプで整理」モード（SwipeAllPhotosScreen）。 |

---

## 3. 新機能「見比べて選ぶ」

### 3.1 入口

- **グループカード（PhotoGroupCard）**
  - サムネイルを**少し大きく**表示する（比較しやすくするため。例: 3列 → 2列など）。
  - **「見比べて選ぶ」**ボタンを1つ追加する。押下で 4分割比較画面に遷移する。
  - 従来の「スワイプで整理」ボタンは削除する。

### 3.2 4分割比較画面（新規画面）

#### 表示レイアウト

- **縦写真のみのグループ**: **2×2**（4枚を2行2列で表示）。
- **横写真のみのグループ**: **4行1列**（4枚を縦に1列で並べる）。
- **縦横混合のグループ**: **2×2**。
- **5枚目以降**: 縦スクロールで、上記ルールに従い 4枚ずつのブロックとして続けて表示する。

**写真の表示仕様**

- 写真全体を表示するのではなく、**表示枠（セル）いっぱいに写真を表示**する。フチが少し見切れていても構わない（aspect fill / 中心寄せでセルを埋める）。
- 元の写真サイズのままでは見比べにくいため、**見比べられる程度の大きさに縮小して表示**する。4枚が同じくらいのスケールで並び、比較しやすいサイズとする。

#### 選択ルール

- **タップ** → その写真を「残す」にする（トグル想定か、タップ＝残すのみかは実装時に合わせてよい）。
- **タップしていない写真** → 削除候補とする。

#### 操作・UI

- **ピンチアウト**: 4分割画面全体をズームする。
- **長押し（1枚）**: その写真をモーダルで大きく表示する。
- **戻るボタン**: 4分割画面を閉じ、ScanScreen のグループ一覧に戻る。選んだ「残す」はストアに反映済みの状態で戻る。
- **説明文**: 「ピンチでズーム、長押しで大きく表示」を小さく表示する。

#### ボタン（4分割画面内）

| ボタン | 動作 |
|--------|------|
| **このグループで削除を実行** | このグループ内の削除候補（残す以外）を確認ダイアログのうえで削除する。 |
| **まとめて削除** | 同上（このグループ内の削除候補を一括削除）。 |
| **次のグループへ** | 次のグループの 4分割比較画面に移行する。最後のグループの場合は「最後のグループです」等の扱いとする。 |

#### アクセシビリティ

- 各写真セルにラベルを付与する（例: 「1枚目、残す選択」「2枚目、削除予定」など）。VoiceOver 等で読み上げ可能にする。

---

## 4. データ・画面遷移

- **ストア**: 4分割画面での「残す」選択は、既存の `keepAssetIds`（SimilarGroup）および `setKeepAssets` で管理する。戻る時点でストアに反映されている。
- **削除実行**: 既存の `deleteAssets(assetIds)` および `removeAssetsFromGroups(assetIds)` を使用する。確認はアラートで行う。
- **次のグループへ**: 現在のグループインデックスとグループIDリストを持ち、次のインデックスで同じ 4分割画面を開き直す（パラメータだけ差し替え）。

---

## 5. 文言・i18n

| キー（想定） | 日本語 |
|--------------|--------|
| 見比べて選ぶ（ボタン） | 見比べて選ぶ |
| 戻る | 戻る |
| このグループで削除を実行 | このグループで削除を実行 |
| まとめて削除 | まとめて削除 |
| 次のグループへ | 次のグループへ |
| ヒント | ピンチでズーム、長押しで大きく表示 |
| ラベル（例） | 1枚目、残す選択 / 2枚目、削除予定 など |

※ キー名・英語訳は実装時に i18n 構造に合わせて定義する。

---

## 6. 非機能・その他

- サムネイル取得は既存の `getThumbnailURL` / `getThumbnailURLs`、拡大表示は `getPreviewImage` を利用する。
- 既存のテーマ（`src/theme/index.ts`）に従う。
- 実装は「実装をお願いします」と依頼があるまで行わない。

---

*作成日: 要件議論の整理として作成。実装前に本要件定義の内容で合意済みとする。*
>>>>>>> d8c7055 (Initial commit)
